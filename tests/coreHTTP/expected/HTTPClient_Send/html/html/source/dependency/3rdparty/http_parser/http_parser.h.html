
<html>
<head>
<title>source/dependency/3rdparty/http_parser/http_parser.h</title>
<link rel="stylesheet" type="text/css" href="../../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /* Copyright Joyent, Inc. and other Node contributors. All rights reserved.</div><div id="2" class="line none">    2  *</div><div id="3" class="line none">    3  * Permission is hereby granted, free of charge, to any person obtaining a copy</div><div id="4" class="line none">    4  * of this software and associated documentation files (the "Software"), to</div><div id="5" class="line none">    5  * deal in the Software without restriction, including without limitation the</div><div id="6" class="line none">    6  * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</div><div id="7" class="line none">    7  * sell copies of the Software, and to permit persons to whom the Software is</div><div id="8" class="line none">    8  * furnished to do so, subject to the following conditions:</div><div id="9" class="line none">    9  *</div><div id="10" class="line none">   10  * The above copyright notice and this permission notice shall be included in</div><div id="11" class="line none">   11  * all copies or substantial portions of the Software.</div><div id="12" class="line none">   12  *</div><div id="13" class="line none">   13  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</div><div id="14" class="line none">   14  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</div><div id="15" class="line none">   15  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</div><div id="16" class="line none">   16  * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</div><div id="17" class="line none">   17  * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</div><div id="18" class="line none">   18  * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS</div><div id="19" class="line none">   19  * IN THE SOFTWARE.</div><div id="20" class="line none">   20  */</div><div id="21" class="line none">   21 #ifndef <a href="http_parser.h.html#22">http_parser_h</a></div><div id="22" class="line none">   22 #define <a href="http_parser.h.html#22">http_parser_h</a></div><div id="23" class="line none">   23 #ifdef __cplusplus</div><div id="24" class="line none">   24 extern "C" {</div><div id="25" class="line none">   25 #endif</div><div id="26" class="line none">   26 </div><div id="27" class="line none">   27 /* Also update SONAME in the Makefile whenever you change these. */</div><div id="28" class="line none">   28 #define <a href="http_parser.h.html#28">HTTP_PARSER_VERSION_MAJOR</a> 2</div><div id="29" class="line none">   29 #define <a href="http_parser.h.html#29">HTTP_PARSER_VERSION_MINOR</a> 9</div><div id="30" class="line none">   30 #define <a href="http_parser.h.html#30">HTTP_PARSER_VERSION_PATCH</a> 4</div><div id="31" class="line none">   31 </div><div id="32" class="line none">   32 #include &lt;stddef.h&gt;</div><div id="33" class="line none">   33 #if defined(_WIN32) &amp;&amp; !defined(__MINGW32__) &amp;&amp; \</div><div id="34" class="line none">   34   (!defined(_MSC_VER) || _MSC_VER&lt;1600) &amp;&amp; !defined(__WINE__)</div><div id="35" class="line none">   35 #include &lt;BaseTsd.h&gt;</div><div id="36" class="line none">   36 typedef __int8 <a href="http_parser.h.html#36">int8_t</a>;</div><div id="37" class="line none">   37 typedef unsigned __int8 <a href="http_parser.h.html#37">uint8_t</a>;</div><div id="38" class="line none">   38 typedef __int16 <a href="http_parser.h.html#38">int16_t</a>;</div><div id="39" class="line none">   39 typedef unsigned __int16 <a href="http_parser.h.html#39">uint16_t</a>;</div><div id="40" class="line none">   40 typedef __int32 <a href="http_parser.h.html#40">int32_t</a>;</div><div id="41" class="line none">   41 typedef unsigned __int32 <a href="http_parser.h.html#41">uint32_t</a>;</div><div id="42" class="line none">   42 typedef __int64 <a href="http_parser.h.html#42">int64_t</a>;</div><div id="43" class="line none">   43 typedef unsigned __int64 <a href="http_parser.h.html#43">uint64_t</a>;</div><div id="44" class="line none">   44 #elif (defined(__sun) || defined(__sun__)) &amp;&amp; defined(__SunOS_5_9)</div><div id="45" class="line none">   45 #include &lt;sys/inttypes.h&gt;</div><div id="46" class="line none">   46 #else</div><div id="47" class="line none">   47 #include &lt;stdint.h&gt;</div><div id="48" class="line none">   48 #endif</div><div id="49" class="line none">   49 </div><div id="50" class="line none">   50 /* Compile with -DHTTP_PARSER_STRICT=0 to make less checks, but run</div><div id="51" class="line none">   51  * faster</div><div id="52" class="line none">   52  */</div><div id="53" class="line none">   53 #ifndef <a href="http_parser.h.html#54">HTTP_PARSER_STRICT</a></div><div id="54" class="line none">   54 # define <a href="http_parser.h.html#54">HTTP_PARSER_STRICT</a> 1</div><div id="55" class="line none">   55 #endif</div><div id="56" class="line none">   56 </div><div id="57" class="line none">   57 /* Maximium header size allowed. If the macro is not defined</div><div id="58" class="line none">   58  * before including this header then the default is used. To</div><div id="59" class="line none">   59  * change the maximum header size, define the macro in the build</div><div id="60" class="line none">   60  * environment (e.g. -DHTTP_MAX_HEADER_SIZE=&lt;value&gt;). To remove</div><div id="61" class="line none">   61  * the effective limit on the size of the header, define the macro</div><div id="62" class="line none">   62  * to a very large number (e.g. -DHTTP_MAX_HEADER_SIZE=0x7fffffff)</div><div id="63" class="line none">   63  */</div><div id="64" class="line none">   64 #ifndef <a href="http_parser.h.html#65">HTTP_MAX_HEADER_SIZE</a></div><div id="65" class="line none">   65 # define <a href="http_parser.h.html#65">HTTP_MAX_HEADER_SIZE</a> (80*1024)</div><div id="66" class="line none">   66 #endif</div><div id="67" class="line none">   67 </div><div id="68" class="line none">   68 typedef struct <a href="http_parser.h.html#68">http_parser</a> <a href="http_parser.h.html#68">http_parser</a>;</div><div id="69" class="line none">   69 typedef struct <a href="http_parser.h.html#69">http_parser_settings</a> <a href="http_parser.h.html#69">http_parser_settings</a>;</div><div id="70" class="line none">   70 </div><div id="71" class="line none">   71 </div><div id="72" class="line none">   72 /* Callbacks should return non-zero to indicate an error. The parser will</div><div id="73" class="line none">   73  * then halt execution.</div><div id="74" class="line none">   74  *</div><div id="75" class="line none">   75  * The one exception is on_headers_complete. In a HTTP_RESPONSE parser</div><div id="76" class="line none">   76  * returning '1' from on_headers_complete will tell the parser that it</div><div id="77" class="line none">   77  * should not expect a body. This is used when receiving a response to a</div><div id="78" class="line none">   78  * HEAD request which may contain 'Content-Length' or 'Transfer-Encoding:</div><div id="79" class="line none">   79  * chunked' headers that indicate the presence of a body.</div><div id="80" class="line none">   80  *</div><div id="81" class="line none">   81  * Returning `2` from on_headers_complete will tell parser that it should not</div><div id="82" class="line none">   82  * expect neither a body nor any futher responses on this connection. This is</div><div id="83" class="line none">   83  * useful for handling responses to a CONNECT request which may not contain</div><div id="84" class="line none">   84  * `Upgrade` or `Connection: upgrade` headers.</div><div id="85" class="line none">   85  *</div><div id="86" class="line none">   86  * http_data_cb does not return data chunks. It will be called arbitrarily</div><div id="87" class="line none">   87  * many times for each string. E.G. you might get 10 callbacks for "on_url"</div><div id="88" class="line none">   88  * each providing just a few characters more data.</div><div id="89" class="line none">   89  */</div><div id="90" class="line none">   90 typedef int (*<a href="http_parser.h.html#90">http_data_cb</a>) (<a href="http_parser.h.html#68">http_parser</a>*, const char *at, size_t length);</div><div id="91" class="line none">   91 typedef int (*<a href="http_parser.h.html#91">http_cb</a>) (<a href="http_parser.h.html#68">http_parser</a>*);</div><div id="92" class="line none">   92 </div><div id="93" class="line none">   93 </div><div id="94" class="line none">   94 /* Status Codes */</div><div id="95" class="line none">   95 #define <a href="http_parser.h.html#159">HTTP_STATUS_MAP</a>(<a href="http_parser.h.html#158">XX</a>)                                                 \</div><div id="96" class="line none">   96   <a href="http_parser.h.html#158">XX</a>(100, CONTINUE,                        Continue)                        \</div><div id="97" class="line none">   97   <a href="http_parser.h.html#158">XX</a>(101, SWITCHING_PROTOCOLS,             Switching Protocols)             \</div><div id="98" class="line none">   98   <a href="http_parser.h.html#158">XX</a>(102, PROCESSING,                      Processing)                      \</div><div id="99" class="line none">   99   <a href="http_parser.h.html#158">XX</a>(200, OK,                              OK)                              \</div><div id="100" class="line none">  100   <a href="http_parser.h.html#158">XX</a>(201, CREATED,                         Created)                         \</div><div id="101" class="line none">  101   <a href="http_parser.h.html#158">XX</a>(202, ACCEPTED,                        Accepted)                        \</div><div id="102" class="line none">  102   <a href="http_parser.h.html#158">XX</a>(203, NON_AUTHORITATIVE_INFORMATION,   Non-Authoritative Information)   \</div><div id="103" class="line none">  103   <a href="http_parser.h.html#158">XX</a>(204, NO_CONTENT,                      No Content)                      \</div><div id="104" class="line none">  104   <a href="http_parser.h.html#158">XX</a>(205, RESET_CONTENT,                   Reset Content)                   \</div><div id="105" class="line none">  105   <a href="http_parser.h.html#158">XX</a>(206, PARTIAL_CONTENT,                 Partial Content)                 \</div><div id="106" class="line none">  106   <a href="http_parser.h.html#158">XX</a>(207, MULTI_STATUS,                    Multi-Status)                    \</div><div id="107" class="line none">  107   <a href="http_parser.h.html#158">XX</a>(208, ALREADY_REPORTED,                Already Reported)                \</div><div id="108" class="line none">  108   <a href="http_parser.h.html#158">XX</a>(226, IM_USED,                         IM Used)                         \</div><div id="109" class="line none">  109   <a href="http_parser.h.html#158">XX</a>(300, MULTIPLE_CHOICES,                Multiple Choices)                \</div><div id="110" class="line none">  110   <a href="http_parser.h.html#158">XX</a>(301, MOVED_PERMANENTLY,               Moved Permanently)               \</div><div id="111" class="line none">  111   <a href="http_parser.h.html#158">XX</a>(302, FOUND,                           Found)                           \</div><div id="112" class="line none">  112   <a href="http_parser.h.html#158">XX</a>(303, SEE_OTHER,                       See Other)                       \</div><div id="113" class="line none">  113   <a href="http_parser.h.html#158">XX</a>(304, NOT_MODIFIED,                    Not Modified)                    \</div><div id="114" class="line none">  114   <a href="http_parser.h.html#158">XX</a>(305, USE_PROXY,                       Use Proxy)                       \</div><div id="115" class="line none">  115   <a href="http_parser.h.html#158">XX</a>(307, TEMPORARY_REDIRECT,              Temporary Redirect)              \</div><div id="116" class="line none">  116   <a href="http_parser.h.html#158">XX</a>(308, PERMANENT_REDIRECT,              Permanent Redirect)              \</div><div id="117" class="line none">  117   <a href="http_parser.h.html#158">XX</a>(400, BAD_REQUEST,                     Bad Request)                     \</div><div id="118" class="line none">  118   <a href="http_parser.h.html#158">XX</a>(401, UNAUTHORIZED,                    Unauthorized)                    \</div><div id="119" class="line none">  119   <a href="http_parser.h.html#158">XX</a>(402, PAYMENT_REQUIRED,                Payment Required)                \</div><div id="120" class="line none">  120   <a href="http_parser.h.html#158">XX</a>(403, FORBIDDEN,                       Forbidden)                       \</div><div id="121" class="line none">  121   <a href="http_parser.h.html#158">XX</a>(404, NOT_FOUND,                       Not Found)                       \</div><div id="122" class="line none">  122   <a href="http_parser.h.html#158">XX</a>(405, METHOD_NOT_ALLOWED,              Method Not Allowed)              \</div><div id="123" class="line none">  123   <a href="http_parser.h.html#158">XX</a>(406, NOT_ACCEPTABLE,                  Not Acceptable)                  \</div><div id="124" class="line none">  124   <a href="http_parser.h.html#158">XX</a>(407, PROXY_AUTHENTICATION_REQUIRED,   Proxy Authentication Required)   \</div><div id="125" class="line none">  125   <a href="http_parser.h.html#158">XX</a>(408, REQUEST_TIMEOUT,                 Request Timeout)                 \</div><div id="126" class="line none">  126   <a href="http_parser.h.html#158">XX</a>(409, CONFLICT,                        Conflict)                        \</div><div id="127" class="line none">  127   <a href="http_parser.h.html#158">XX</a>(410, GONE,                            Gone)                            \</div><div id="128" class="line none">  128   <a href="http_parser.h.html#158">XX</a>(411, LENGTH_REQUIRED,                 Length Required)                 \</div><div id="129" class="line none">  129   <a href="http_parser.h.html#158">XX</a>(412, PRECONDITION_FAILED,             Precondition Failed)             \</div><div id="130" class="line none">  130   <a href="http_parser.h.html#158">XX</a>(413, PAYLOAD_TOO_LARGE,               Payload Too Large)               \</div><div id="131" class="line none">  131   <a href="http_parser.h.html#158">XX</a>(414, URI_TOO_LONG,                    URI Too Long)                    \</div><div id="132" class="line none">  132   <a href="http_parser.h.html#158">XX</a>(415, UNSUPPORTED_MEDIA_TYPE,          Unsupported Media Type)          \</div><div id="133" class="line none">  133   <a href="http_parser.h.html#158">XX</a>(416, RANGE_NOT_SATISFIABLE,           Range Not Satisfiable)           \</div><div id="134" class="line none">  134   <a href="http_parser.h.html#158">XX</a>(417, EXPECTATION_FAILED,              Expectation Failed)              \</div><div id="135" class="line none">  135   <a href="http_parser.h.html#158">XX</a>(421, MISDIRECTED_REQUEST,             Misdirected Request)             \</div><div id="136" class="line none">  136   <a href="http_parser.h.html#158">XX</a>(422, UNPROCESSABLE_ENTITY,            Unprocessable Entity)            \</div><div id="137" class="line none">  137   <a href="http_parser.h.html#158">XX</a>(423, LOCKED,                          Locked)                          \</div><div id="138" class="line none">  138   <a href="http_parser.h.html#158">XX</a>(424, FAILED_DEPENDENCY,               Failed Dependency)               \</div><div id="139" class="line none">  139   <a href="http_parser.h.html#158">XX</a>(426, UPGRADE_REQUIRED,                Upgrade Required)                \</div><div id="140" class="line none">  140   <a href="http_parser.h.html#158">XX</a>(428, PRECONDITION_REQUIRED,           Precondition Required)           \</div><div id="141" class="line none">  141   <a href="http_parser.h.html#158">XX</a>(429, TOO_MANY_REQUESTS,               Too Many Requests)               \</div><div id="142" class="line none">  142   <a href="http_parser.h.html#158">XX</a>(431, REQUEST_HEADER_FIELDS_TOO_LARGE, Request Header Fields Too Large) \</div><div id="143" class="line none">  143   <a href="http_parser.h.html#158">XX</a>(451, UNAVAILABLE_FOR_LEGAL_REASONS,   Unavailable For Legal Reasons)   \</div><div id="144" class="line none">  144   <a href="http_parser.h.html#158">XX</a>(500, INTERNAL_SERVER_ERROR,           Internal Server Error)           \</div><div id="145" class="line none">  145   <a href="http_parser.h.html#158">XX</a>(501, NOT_IMPLEMENTED,                 Not Implemented)                 \</div><div id="146" class="line none">  146   <a href="http_parser.h.html#158">XX</a>(502, BAD_GATEWAY,                     Bad Gateway)                     \</div><div id="147" class="line none">  147   <a href="http_parser.h.html#158">XX</a>(503, SERVICE_UNAVAILABLE,             Service Unavailable)             \</div><div id="148" class="line none">  148   <a href="http_parser.h.html#158">XX</a>(504, GATEWAY_TIMEOUT,                 Gateway Timeout)                 \</div><div id="149" class="line none">  149   <a href="http_parser.h.html#158">XX</a>(505, HTTP_VERSION_NOT_SUPPORTED,      HTTP Version Not Supported)      \</div><div id="150" class="line none">  150   <a href="http_parser.h.html#158">XX</a>(506, VARIANT_ALSO_NEGOTIATES,         Variant Also Negotiates)         \</div><div id="151" class="line none">  151   <a href="http_parser.h.html#158">XX</a>(507, INSUFFICIENT_STORAGE,            Insufficient Storage)            \</div><div id="152" class="line none">  152   <a href="http_parser.h.html#158">XX</a>(508, LOOP_DETECTED,                   Loop Detected)                   \</div><div id="153" class="line none">  153   <a href="http_parser.h.html#158">XX</a>(510, NOT_EXTENDED,                    Not Extended)                    \</div><div id="154" class="line none">  154   <a href="http_parser.h.html#158">XX</a>(511, NETWORK_AUTHENTICATION_REQUIRED, Network Authentication Required) \</div><div id="155" class="line none">  155 </div><div id="156" class="line none">  156 enum <a href="http_parser.h.html#156">http_status</a></div><div id="157" class="line none">  157   {</div><div id="158" class="line none">  158 #define <a href="http_parser.h.html#158">XX</a>(num, name, string) HTTP_STATUS_##name = num,</div><div id="159" class="line none">  159   <a href="http_parser.h.html#159">HTTP_STATUS_MAP</a>(<a href="http_parser.h.html#158">XX</a>)</div><div id="160" class="line none">  160 #undef <a href="http_parser.h.html#158">XX</a></div><div id="161" class="line none">  161   };</div><div id="162" class="line none">  162 </div><div id="163" class="line none">  163 </div><div id="164" class="line none">  164 /* Request Methods */</div><div id="165" class="line none">  165 #define <a href="http_parser.h.html#212">HTTP_METHOD_MAP</a>(<a href="http_parser.h.html#158">XX</a>)         \</div><div id="166" class="line none">  166   <a href="http_parser.h.html#158">XX</a>(0,  DELETE,      DELETE)       \</div><div id="167" class="line none">  167   <a href="http_parser.h.html#158">XX</a>(1,  GET,         GET)          \</div><div id="168" class="line none">  168   <a href="http_parser.h.html#158">XX</a>(2,  HEAD,        HEAD)         \</div><div id="169" class="line none">  169   <a href="http_parser.h.html#158">XX</a>(3,  POST,        POST)         \</div><div id="170" class="line none">  170   <a href="http_parser.h.html#158">XX</a>(4,  PUT,         PUT)          \</div><div id="171" class="line none">  171   /* pathological */                \</div><div id="172" class="line none">  172   <a href="http_parser.h.html#158">XX</a>(5,  CONNECT,     CONNECT)      \</div><div id="173" class="line none">  173   <a href="http_parser.h.html#158">XX</a>(6,  OPTIONS,     OPTIONS)      \</div><div id="174" class="line none">  174   <a href="http_parser.h.html#158">XX</a>(7,  TRACE,       TRACE)        \</div><div id="175" class="line none">  175   /* WebDAV */                      \</div><div id="176" class="line none">  176   <a href="http_parser.h.html#158">XX</a>(8,  COPY,        COPY)         \</div><div id="177" class="line none">  177   <a href="http_parser.h.html#158">XX</a>(9,  LOCK,        LOCK)         \</div><div id="178" class="line none">  178   <a href="http_parser.h.html#158">XX</a>(10, MKCOL,       MKCOL)        \</div><div id="179" class="line none">  179   <a href="http_parser.h.html#158">XX</a>(11, MOVE,        MOVE)         \</div><div id="180" class="line none">  180   <a href="http_parser.h.html#158">XX</a>(12, PROPFIND,    PROPFIND)     \</div><div id="181" class="line none">  181   <a href="http_parser.h.html#158">XX</a>(13, PROPPATCH,   PROPPATCH)    \</div><div id="182" class="line none">  182   <a href="http_parser.h.html#158">XX</a>(14, SEARCH,      SEARCH)       \</div><div id="183" class="line none">  183   <a href="http_parser.h.html#158">XX</a>(15, UNLOCK,      UNLOCK)       \</div><div id="184" class="line none">  184   <a href="http_parser.h.html#158">XX</a>(16, BIND,        BIND)         \</div><div id="185" class="line none">  185   <a href="http_parser.h.html#158">XX</a>(17, REBIND,      REBIND)       \</div><div id="186" class="line none">  186   <a href="http_parser.h.html#158">XX</a>(18, UNBIND,      UNBIND)       \</div><div id="187" class="line none">  187   <a href="http_parser.h.html#158">XX</a>(19, ACL,         ACL)          \</div><div id="188" class="line none">  188   /* subversion */                  \</div><div id="189" class="line none">  189   <a href="http_parser.h.html#158">XX</a>(20, REPORT,      REPORT)       \</div><div id="190" class="line none">  190   <a href="http_parser.h.html#158">XX</a>(21, MKACTIVITY,  MKACTIVITY)   \</div><div id="191" class="line none">  191   <a href="http_parser.h.html#158">XX</a>(22, CHECKOUT,    CHECKOUT)     \</div><div id="192" class="line none">  192   <a href="http_parser.h.html#158">XX</a>(23, MERGE,       MERGE)        \</div><div id="193" class="line none">  193   /* upnp */                        \</div><div id="194" class="line none">  194   <a href="http_parser.h.html#158">XX</a>(24, MSEARCH,     M-SEARCH)     \</div><div id="195" class="line none">  195   <a href="http_parser.h.html#158">XX</a>(25, NOTIFY,      NOTIFY)       \</div><div id="196" class="line none">  196   <a href="http_parser.h.html#158">XX</a>(26, SUBSCRIBE,   SUBSCRIBE)    \</div><div id="197" class="line none">  197   <a href="http_parser.h.html#158">XX</a>(27, UNSUBSCRIBE, UNSUBSCRIBE)  \</div><div id="198" class="line none">  198   /* RFC-5789 */                    \</div><div id="199" class="line none">  199   <a href="http_parser.h.html#158">XX</a>(28, PATCH,       PATCH)        \</div><div id="200" class="line none">  200   <a href="http_parser.h.html#158">XX</a>(29, PURGE,       PURGE)        \</div><div id="201" class="line none">  201   /* CalDAV */                      \</div><div id="202" class="line none">  202   <a href="http_parser.h.html#158">XX</a>(30, MKCALENDAR,  MKCALENDAR)   \</div><div id="203" class="line none">  203   /* RFC-2068, section 19.6.1.2 */  \</div><div id="204" class="line none">  204   <a href="http_parser.h.html#158">XX</a>(31, LINK,        LINK)         \</div><div id="205" class="line none">  205   <a href="http_parser.h.html#158">XX</a>(32, UNLINK,      UNLINK)       \</div><div id="206" class="line none">  206   /* icecast */                     \</div><div id="207" class="line none">  207   <a href="http_parser.h.html#158">XX</a>(33, SOURCE,      SOURCE)       \</div><div id="208" class="line none">  208 </div><div id="209" class="line none">  209 enum <a href="http_parser.h.html#209">http_method</a></div><div id="210" class="line none">  210   {</div><div id="211" class="line none">  211 #define <a href="http_parser.h.html#158">XX</a>(num, name, string) HTTP_##name = num,</div><div id="212" class="line none">  212   <a href="http_parser.h.html#212">HTTP_METHOD_MAP</a>(<a href="http_parser.h.html#158">XX</a>)</div><div id="213" class="line none">  213 #undef <a href="http_parser.h.html#158">XX</a></div><div id="214" class="line none">  214   };</div><div id="215" class="line none">  215 </div><div id="216" class="line none">  216 </div><div id="217" class="line none">  217 enum <a href="http_parser.h.html#217">http_parser_type</a> { <a href="http_parser.h.html#217">HTTP_REQUEST</a>, <a href="http_parser.h.html#217">HTTP_RESPONSE</a>, <a href="http_parser.h.html#217">HTTP_BOTH</a> };</div><div id="218" class="line none">  218 </div><div id="219" class="line none">  219 </div><div id="220" class="line none">  220 /* Flag values for http_parser.flags field */</div><div id="221" class="line none">  221 enum <a href="http_parser.h.html#221">flags</a></div><div id="222" class="line none">  222   { <a href="http_parser.h.html#222">F_CHUNKED</a>               = 1 &lt;&lt; 0</div><div id="223" class="line none">  223   , <a href="http_parser.h.html#223">F_CONNECTION_KEEP_ALIVE</a> = 1 &lt;&lt; 1</div><div id="224" class="line none">  224   , <a href="http_parser.h.html#224">F_CONNECTION_CLOSE</a>      = 1 &lt;&lt; 2</div><div id="225" class="line none">  225   , <a href="http_parser.h.html#225">F_CONNECTION_UPGRADE</a>    = 1 &lt;&lt; 3</div><div id="226" class="line none">  226   , <a href="http_parser.h.html#226">F_TRAILING</a>              = 1 &lt;&lt; 4</div><div id="227" class="line none">  227   , <a href="http_parser.h.html#227">F_UPGRADE</a>               = 1 &lt;&lt; 5</div><div id="228" class="line none">  228   , <a href="http_parser.h.html#228">F_SKIPBODY</a>              = 1 &lt;&lt; 6</div><div id="229" class="line none">  229   , <a href="http_parser.h.html#229">F_CONTENTLENGTH</a>         = 1 &lt;&lt; 7</div><div id="230" class="line none">  230   };</div><div id="231" class="line none">  231 </div><div id="232" class="line none">  232 </div><div id="233" class="line none">  233 /* Map for errno-related constants</div><div id="234" class="line none">  234  *</div><div id="235" class="line none">  235  * The provided argument should be a macro that takes 2 arguments.</div><div id="236" class="line none">  236  */</div><div id="237" class="line none">  237 #define <a href="http_parser.h.html#288">HTTP_ERRNO_MAP</a>(<a href="http_parser.h.html#158">XX</a>)                                           \</div><div id="238" class="line none">  238   /* No error */                                                     \</div><div id="239" class="line none">  239   <a href="http_parser.h.html#158">XX</a>(OK, "success")                                                  \</div><div id="240" class="line none">  240                                                                      \</div><div id="241" class="line none">  241   /* Callback-related errors */                                      \</div><div id="242" class="line none">  242   <a href="http_parser.h.html#158">XX</a>(CB_message_begin, "the on_message_begin callback failed")       \</div><div id="243" class="line none">  243   <a href="http_parser.h.html#158">XX</a>(CB_url, "the on_url callback failed")                           \</div><div id="244" class="line none">  244   <a href="http_parser.h.html#158">XX</a>(CB_header_field, "the on_header_field callback failed")         \</div><div id="245" class="line none">  245   <a href="http_parser.h.html#158">XX</a>(CB_header_value, "the on_header_value callback failed")         \</div><div id="246" class="line none">  246   <a href="http_parser.h.html#158">XX</a>(CB_headers_complete, "the on_headers_complete callback failed") \</div><div id="247" class="line none">  247   <a href="http_parser.h.html#158">XX</a>(CB_body, "the on_body callback failed")                         \</div><div id="248" class="line none">  248   <a href="http_parser.h.html#158">XX</a>(CB_message_complete, "the on_message_complete callback failed") \</div><div id="249" class="line none">  249   <a href="http_parser.h.html#158">XX</a>(CB_status, "the on_status callback failed")                     \</div><div id="250" class="line none">  250   <a href="http_parser.h.html#158">XX</a>(CB_chunk_header, "the on_chunk_header callback failed")         \</div><div id="251" class="line none">  251   <a href="http_parser.h.html#158">XX</a>(CB_chunk_complete, "the on_chunk_complete callback failed")     \</div><div id="252" class="line none">  252                                                                      \</div><div id="253" class="line none">  253   /* Parsing-related errors */                                       \</div><div id="254" class="line none">  254   <a href="http_parser.h.html#158">XX</a>(INVALID_EOF_STATE, "stream ended at an unexpected time")        \</div><div id="255" class="line none">  255   <a href="http_parser.h.html#158">XX</a>(HEADER_OVERFLOW,                                                \</div><div id="256" class="line none">  256      "too many header bytes seen; overflow detected")                \</div><div id="257" class="line none">  257   <a href="http_parser.h.html#158">XX</a>(CLOSED_CONNECTION,                                              \</div><div id="258" class="line none">  258      "data received after completed connection: close message")      \</div><div id="259" class="line none">  259   <a href="http_parser.h.html#158">XX</a>(INVALID_VERSION, "invalid HTTP version")                        \</div><div id="260" class="line none">  260   <a href="http_parser.h.html#158">XX</a>(INVALID_STATUS, "invalid HTTP status code")                     \</div><div id="261" class="line none">  261   <a href="http_parser.h.html#158">XX</a>(INVALID_METHOD, "invalid HTTP method")                          \</div><div id="262" class="line none">  262   <a href="http_parser.h.html#158">XX</a>(INVALID_URL, "invalid URL")                                     \</div><div id="263" class="line none">  263   <a href="http_parser.h.html#158">XX</a>(INVALID_HOST, "invalid host")                                   \</div><div id="264" class="line none">  264   <a href="http_parser.h.html#158">XX</a>(INVALID_PORT, "invalid port")                                   \</div><div id="265" class="line none">  265   <a href="http_parser.h.html#158">XX</a>(INVALID_PATH, "invalid path")                                   \</div><div id="266" class="line none">  266   <a href="http_parser.h.html#158">XX</a>(INVALID_QUERY_STRING, "invalid query string")                   \</div><div id="267" class="line none">  267   <a href="http_parser.h.html#158">XX</a>(INVALID_FRAGMENT, "invalid fragment")                           \</div><div id="268" class="line none">  268   <a href="http_parser.h.html#158">XX</a>(LF_EXPECTED, "LF character expected")                           \</div><div id="269" class="line none">  269   <a href="http_parser.h.html#158">XX</a>(INVALID_HEADER_TOKEN, "invalid character in header")            \</div><div id="270" class="line none">  270   <a href="http_parser.h.html#158">XX</a>(INVALID_CONTENT_LENGTH,                                         \</div><div id="271" class="line none">  271      "invalid character in content-length header")                   \</div><div id="272" class="line none">  272   <a href="http_parser.h.html#158">XX</a>(UNEXPECTED_CONTENT_LENGTH,                                      \</div><div id="273" class="line none">  273      "unexpected content-length header")                             \</div><div id="274" class="line none">  274   <a href="http_parser.h.html#158">XX</a>(INVALID_CHUNK_SIZE,                                             \</div><div id="275" class="line none">  275      "invalid character in chunk size header")                       \</div><div id="276" class="line none">  276   <a href="http_parser.h.html#158">XX</a>(INVALID_CONSTANT, "invalid constant string")                    \</div><div id="277" class="line none">  277   <a href="http_parser.h.html#158">XX</a>(INVALID_INTERNAL_STATE, "encountered unexpected internal state")\</div><div id="278" class="line none">  278   <a href="http_parser.h.html#158">XX</a>(STRICT, "strict mode assertion failed")                         \</div><div id="279" class="line none">  279   <a href="http_parser.h.html#158">XX</a>(PAUSED, "parser is paused")                                     \</div><div id="280" class="line none">  280   <a href="http_parser.h.html#158">XX</a>(UNKNOWN, "an unknown error occurred")                           \</div><div id="281" class="line none">  281   <a href="http_parser.h.html#158">XX</a>(INVALID_TRANSFER_ENCODING,                                      \</div><div id="282" class="line none">  282      "request has invalid transfer-encoding")                        \</div><div id="283" class="line none">  283 </div><div id="284" class="line none">  284 </div><div id="285" class="line none">  285 /* Define HPE_* values for each errno value above */</div><div id="286" class="line none">  286 #define <a href="http_parser.h.html#286">HTTP_ERRNO_GEN</a>(n, s) HPE_##n,</div><div id="287" class="line none">  287 enum <a href="http_parser.h.html#287">http_errno</a> {</div><div id="288" class="line none">  288   <a href="http_parser.h.html#288">HTTP_ERRNO_MAP</a>(<a href="http_parser.h.html#286">HTTP_ERRNO_GEN</a>)</div><div id="289" class="line none">  289 };</div><div id="290" class="line none">  290 #undef <a href="http_parser.h.html#286">HTTP_ERRNO_GEN</a></div><div id="291" class="line none">  291 </div><div id="292" class="line none">  292 </div><div id="293" class="line none">  293 /* Get an http_errno value from an http_parser */</div><div id="294" class="line none">  294 #define <a href="http_parser.h.html#294">HTTP_PARSER_ERRNO</a>(p)            ((enum <a href="http_parser.h.html#287">http_errno</a>) (p)-&gt;<a href="http_parser.h.html#287">http_errno</a>)</div><div id="295" class="line none">  295 </div><div id="296" class="line none">  296 </div><div id="297" class="line none">  297 struct <a href="http_parser.h.html#68">http_parser</a> {</div><div id="298" class="line none">  298   /** PRIVATE **/</div><div id="299" class="line none">  299   unsigned int <a href="http_parser.h.html#299">type</a> : 2;         /* enum http_parser_type */</div><div id="300" class="line none">  300   unsigned int <a href="http_parser.h.html#221">flags</a> : 8;       /* F_* values from 'flags' enum; semi-public */</div><div id="301" class="line none">  301   unsigned int <a href="../../../include/core_http_client_private.h.html#265">state</a> : 7;        /* enum state from http_parser.c */</div><div id="302" class="line none">  302   unsigned int <a href="http_parser.h.html#302">header_state</a> : 7; /* enum header_state from http_parser.c */</div><div id="303" class="line none">  303   unsigned int <a href="http_parser.h.html#303">index</a> : 5;        /* index into current matcher */</div><div id="304" class="line none">  304   unsigned int <a href="http_parser.h.html#304">uses_transfer_encoding</a> : 1; /* Transfer-Encoding header is present */</div><div id="305" class="line none">  305   unsigned int <a href="http_parser.h.html#305">allow_chunked_length</a> : 1; /* Allow headers with both</div><div id="306" class="line none">  306                                           * `Content-Length` and</div><div id="307" class="line none">  307                                           * `Transfer-Encoding: chunked` set */</div><div id="308" class="line none">  308   unsigned int <a href="http_parser.h.html#308">lenient_http_headers</a> : 1;</div><div id="309" class="line none">  309 </div><div id="310" class="line none">  310   <a href="http_parser.h.html#41">uint32_t</a> <a href="http_parser.h.html#310">nread</a>;          /* # bytes read in various scenarios */</div><div id="311" class="line none">  311   <a href="http_parser.h.html#43">uint64_t</a> <a href="http_parser.h.html#311">content_length</a>; /* # bytes in body. `(uint64_t) -1` (all bits one)</div><div id="312" class="line none">  312                             * if no Content-Length header.</div><div id="313" class="line none">  313                             */</div><div id="314" class="line none">  314 </div><div id="315" class="line none">  315   /** READ-ONLY **/</div><div id="316" class="line none">  316   unsigned short <a href="http_parser.h.html#316">http_major</a>;</div><div id="317" class="line none">  317   unsigned short <a href="http_parser.h.html#317">http_minor</a>;</div><div id="318" class="line none">  318   unsigned int <a href="http_parser.h.html#318">status_code</a> : 16; /* responses only */</div><div id="319" class="line none">  319   unsigned int <a href="http_parser.h.html#319">method</a> : 8;       /* requests only */</div><div id="320" class="line none">  320   unsigned int <a href="http_parser.h.html#287">http_errno</a> : 7;</div><div id="321" class="line none">  321 </div><div id="322" class="line none">  322   /* 1 = Upgrade header was present and the parser has exited because of that.</div><div id="323" class="line none">  323    * 0 = No upgrade header present.</div><div id="324" class="line none">  324    * Should be checked when http_parser_execute() returns in addition to</div><div id="325" class="line none">  325    * error checking.</div><div id="326" class="line none">  326    */</div><div id="327" class="line none">  327   unsigned int <a href="http_parser.h.html#327">upgrade</a> : 1;</div><div id="328" class="line none">  328 </div><div id="329" class="line none">  329   /** PUBLIC **/</div><div id="330" class="line none">  330   void *<a href="http_parser.h.html#330">data</a>; /* A pointer to get hook to the "connection" or "socket" object */</div><div id="331" class="line none">  331 };</div><div id="332" class="line none">  332 </div><div id="333" class="line none">  333 </div><div id="334" class="line none">  334 struct <a href="http_parser.h.html#69">http_parser_settings</a> {</div><div id="335" class="line none">  335   <a href="http_parser.h.html#91">http_cb</a>      <a href="http_parser.h.html#335">on_message_begin</a>;</div><div id="336" class="line none">  336   <a href="http_parser.h.html#90">http_data_cb</a> <a href="http_parser.h.html#336">on_url</a>;</div><div id="337" class="line none">  337   <a href="http_parser.h.html#90">http_data_cb</a> <a href="http_parser.h.html#337">on_status</a>;</div><div id="338" class="line none">  338   <a href="http_parser.h.html#90">http_data_cb</a> <a href="http_parser.h.html#338">on_header_field</a>;</div><div id="339" class="line none">  339   <a href="http_parser.h.html#90">http_data_cb</a> <a href="http_parser.h.html#339">on_header_value</a>;</div><div id="340" class="line none">  340   <a href="http_parser.h.html#91">http_cb</a>      <a href="http_parser.h.html#340">on_headers_complete</a>;</div><div id="341" class="line none">  341   <a href="http_parser.h.html#90">http_data_cb</a> <a href="http_parser.h.html#341">on_body</a>;</div><div id="342" class="line none">  342   <a href="http_parser.h.html#91">http_cb</a>      <a href="http_parser.h.html#342">on_message_complete</a>;</div><div id="343" class="line none">  343   /* When on_chunk_header is called, the current chunk length is stored</div><div id="344" class="line none">  344    * in parser-&gt;content_length.</div><div id="345" class="line none">  345    */</div><div id="346" class="line none">  346   <a href="http_parser.h.html#91">http_cb</a>      <a href="http_parser.h.html#346">on_chunk_header</a>;</div><div id="347" class="line none">  347   <a href="http_parser.h.html#91">http_cb</a>      <a href="http_parser.h.html#347">on_chunk_complete</a>;</div><div id="348" class="line none">  348 };</div><div id="349" class="line none">  349 </div><div id="350" class="line none">  350 </div><div id="351" class="line none">  351 enum <a href="http_parser.h.html#351">http_parser_url_fields</a></div><div id="352" class="line none">  352   { <a href="http_parser.h.html#352">UF_SCHEMA</a>           = 0</div><div id="353" class="line none">  353   , <a href="http_parser.h.html#353">UF_HOST</a>             = 1</div><div id="354" class="line none">  354   , <a href="http_parser.h.html#354">UF_PORT</a>             = 2</div><div id="355" class="line none">  355   , <a href="http_parser.h.html#355">UF_PATH</a>             = 3</div><div id="356" class="line none">  356   , <a href="http_parser.h.html#356">UF_QUERY</a>            = 4</div><div id="357" class="line none">  357   , <a href="http_parser.h.html#357">UF_FRAGMENT</a>         = 5</div><div id="358" class="line none">  358   , <a href="http_parser.h.html#358">UF_USERINFO</a>         = 6</div><div id="359" class="line none">  359   , <a href="http_parser.h.html#359">UF_MAX</a>              = 7</div><div id="360" class="line none">  360   };</div><div id="361" class="line none">  361 </div><div id="362" class="line none">  362 </div><div id="363" class="line none">  363 /* Result structure for http_parser_parse_url().</div><div id="364" class="line none">  364  *</div><div id="365" class="line none">  365  * Callers should index into field_data[] with UF_* values iff field_set</div><div id="366" class="line none">  366  * has the relevant (1 &lt;&lt; UF_*) bit set. As a courtesy to clients (and</div><div id="367" class="line none">  367  * because we probably have padding left over), we convert any port to</div><div id="368" class="line none">  368  * a uint16_t.</div><div id="369" class="line none">  369  */</div><div id="370" class="line none">  370 struct <a href="http_parser.h.html#370">http_parser_url</a> {</div><div id="371" class="line none">  371   <a href="http_parser.h.html#39">uint16_t</a> <a href="http_parser.h.html#371">field_set</a>;           /* Bitmask of (1 &lt;&lt; UF_*) values */</div><div id="372" class="line none">  372   <a href="http_parser.h.html#39">uint16_t</a> <a href="http_parser.h.html#372">port</a>;                /* Converted UF_PORT string */</div><div id="373" class="line none">  373 </div><div id="374" class="line none">  374   struct {</div><div id="375" class="line none">  375     <a href="http_parser.h.html#39">uint16_t</a> <a href="http_parser.h.html#375">off</a>;               /* Offset into buffer in which field starts */</div><div id="376" class="line none">  376     <a href="http_parser.h.html#39">uint16_t</a> <a href="http_parser.h.html#376">len</a>;               /* Length of run in buffer */</div><div id="377" class="line none">  377   } <a href="http_parser.h.html#377">field_data</a>[<a href="http_parser.h.html#359">UF_MAX</a>];</div><div id="378" class="line none">  378 };</div><div id="379" class="line none">  379 </div><div id="380" class="line none">  380 </div><div id="381" class="line none">  381 /* Returns the library version. Bits 16-23 contain the major version number,</div><div id="382" class="line none">  382  * bits 8-15 the minor version number and bits 0-7 the patch level.</div><div id="383" class="line none">  383  * Usage example:</div><div id="384" class="line none">  384  *</div><div id="385" class="line none">  385  *   unsigned long version = http_parser_version();</div><div id="386" class="line none">  386  *   unsigned major = (version &gt;&gt; 16) &amp; 255;</div><div id="387" class="line none">  387  *   unsigned minor = (version &gt;&gt; 8) &amp; 255;</div><div id="388" class="line none">  388  *   unsigned patch = version &amp; 255;</div><div id="389" class="line none">  389  *   printf("http_parser v%u.%u.%u\n", major, minor, patch);</div><div id="390" class="line none">  390  */</div><div id="391" class="line none">  391 unsigned long http_parser_version(void);</div><div id="392" class="line none">  392 </div><div id="393" class="line none">  393 void <a href="http_parser.h.html#393">http_parser_init</a>(<a href="http_parser.h.html#68">http_parser</a> *parser, enum <a href="http_parser.h.html#217">http_parser_type</a> <a href="http_parser.h.html#299">type</a>);</div><div id="394" class="line none">  394 </div><div id="395" class="line none">  395 </div><div id="396" class="line none">  396 /* Initialize http_parser_settings members to 0</div><div id="397" class="line none">  397  */</div><div id="398" class="line none">  398 void <a href="http_parser.h.html#398">http_parser_settings_init</a>(<a href="http_parser.h.html#69">http_parser_settings</a> *settings);</div><div id="399" class="line none">  399 </div><div id="400" class="line none">  400 </div><div id="401" class="line none">  401 /* Executes the parser. Returns number of parsed bytes. Sets</div><div id="402" class="line none">  402  * `parser-&gt;http_errno` on error. */</div><div id="403" class="line none">  403 size_t <a href="../../../../test/cbmc/stubs/HTTPClient_Send_http_parser_execute.c.html#41">http_parser_execute</a>(<a href="http_parser.h.html#68">http_parser</a> *parser,</div><div id="404" class="line none">  404                            const <a href="http_parser.h.html#69">http_parser_settings</a> *settings,</div><div id="405" class="line none">  405                            const char *<a href="http_parser.h.html#330">data</a>,</div><div id="406" class="line none">  406                            size_t <a href="http_parser.h.html#376">len</a>);</div><div id="407" class="line none">  407 </div><div id="408" class="line none">  408 </div><div id="409" class="line none">  409 /* If http_should_keep_alive() in the on_headers_complete or</div><div id="410" class="line none">  410  * on_message_complete callback returns 0, then this should be</div><div id="411" class="line none">  411  * the last message on the connection.</div><div id="412" class="line none">  412  * If you are the server, respond with the "Connection: close" header.</div><div id="413" class="line none">  413  * If you are the client, close the connection.</div><div id="414" class="line none">  414  */</div><div id="415" class="line none">  415 int http_should_keep_alive(const <a href="http_parser.h.html#68">http_parser</a> *parser);</div><div id="416" class="line none">  416 </div><div id="417" class="line none">  417 /* Returns a string version of the HTTP method. */</div><div id="418" class="line none">  418 const char *http_method_str(enum <a href="http_parser.h.html#209">http_method</a> m);</div><div id="419" class="line none">  419 </div><div id="420" class="line none">  420 /* Returns a string version of the HTTP status code. */</div><div id="421" class="line none">  421 const char *http_status_str(enum <a href="http_parser.h.html#156">http_status</a> s);</div><div id="422" class="line none">  422 </div><div id="423" class="line none">  423 /* Return a string name of the given error */</div><div id="424" class="line none">  424 const char *http_errno_name(enum <a href="http_parser.h.html#287">http_errno</a> err);</div><div id="425" class="line none">  425 </div><div id="426" class="line none">  426 /* Return a string description of the given error */</div><div id="427" class="line none">  427 const char *http_errno_description(enum <a href="http_parser.h.html#287">http_errno</a> err);</div><div id="428" class="line none">  428 </div><div id="429" class="line none">  429 /* Initialize all http_parser_url members to 0 */</div><div id="430" class="line none">  430 void http_parser_url_init(struct <a href="http_parser.h.html#370">http_parser_url</a> *u);</div><div id="431" class="line none">  431 </div><div id="432" class="line none">  432 /* Parse a URL; return nonzero on failure */</div><div id="433" class="line none">  433 int http_parser_parse_url(const char *buf, size_t buflen,</div><div id="434" class="line none">  434                           int is_connect,</div><div id="435" class="line none">  435                           struct <a href="http_parser.h.html#370">http_parser_url</a> *u);</div><div id="436" class="line none">  436 </div><div id="437" class="line none">  437 /* Pause or un-pause the parser; a nonzero value pauses */</div><div id="438" class="line none">  438 void http_parser_pause(<a href="http_parser.h.html#68">http_parser</a> *parser, int paused);</div><div id="439" class="line none">  439 </div><div id="440" class="line none">  440 /* Checks if this is the final chunk of the body. */</div><div id="441" class="line none">  441 int http_body_is_final(const <a href="http_parser.h.html#68">http_parser</a> *parser);</div><div id="442" class="line none">  442 </div><div id="443" class="line none">  443 /* Change the maximum header size provided at compile time. */</div><div id="444" class="line none">  444 void <a href="http_parser.h.html#444">http_parser_set_max_header_size</a>(<a href="http_parser.h.html#41">uint32_t</a> size);</div><div id="445" class="line none">  445 </div><div id="446" class="line none">  446 #ifdef __cplusplus</div><div id="447" class="line none">  447 }</div><div id="448" class="line none">  448 #endif</div><div id="449" class="line none">  449 #endif</div>
</div>
</body>
</html>
