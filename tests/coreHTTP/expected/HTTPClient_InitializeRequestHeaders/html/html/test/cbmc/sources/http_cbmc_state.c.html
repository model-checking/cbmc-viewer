
<html>
<head>
<title>test/cbmc/sources/http_cbmc_state.c</title>
<link rel="stylesheet" type="text/css" href="../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /*</div><div id="2" class="line none">    2  * coreHTTP v2.0.2</div><div id="3" class="line none">    3  * Copyright (C) 2020 Amazon.com, Inc. or its affiliates.  All Rights Reserved.</div><div id="4" class="line none">    4  *</div><div id="5" class="line none">    5  * Permission is hereby granted, free of charge, to any person obtaining a copy of</div><div id="6" class="line none">    6  * this software and associated documentation files (the "Software"), to deal in</div><div id="7" class="line none">    7  * the Software without restriction, including without limitation the rights to</div><div id="8" class="line none">    8  * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of</div><div id="9" class="line none">    9  * the Software, and to permit persons to whom the Software is furnished to do so,</div><div id="10" class="line none">   10  * subject to the following conditions:</div><div id="11" class="line none">   11  *</div><div id="12" class="line none">   12  * The above copyright notice and this permission notice shall be included in all</div><div id="13" class="line none">   13  * copies or substantial portions of the Software.</div><div id="14" class="line none">   14  *</div><div id="15" class="line none">   15  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</div><div id="16" class="line none">   16  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS</div><div id="17" class="line none">   17  * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR</div><div id="18" class="line none">   18  * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER</div><div id="19" class="line none">   19  * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</div><div id="20" class="line none">   20  * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</div><div id="21" class="line none">   21  */</div><div id="22" class="line none">   22 </div><div id="23" class="line none">   23 /**</div><div id="24" class="line none">   24  * @file http_cbmc_state.c</div><div id="25" class="line none">   25  * @brief Implements the functions in http_cbmc_state.h.</div><div id="26" class="line none">   26  */</div><div id="27" class="line none">   27 </div><div id="28" class="line none">   28 #include &lt;stdlib.h&gt;</div><div id="29" class="line none">   29 </div><div id="30" class="line none">   30 #include "http_cbmc_state.h"</div><div id="31" class="line none">   31 </div><div id="32" class="line none">   32 void * <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( size_t size )</div><div id="33" class="line none">   33 {</div><div id="34" class="line hit">   34     __CPROVER_assert( size &lt; CBMC_MAX_OBJECT_SIZE, "mallocCanFail size is too big" );</div><div id="35" class="line hit">   35     return malloc( size );</div><div id="36" class="line hit">   36 }</div><div id="37" class="line none">   37 </div><div id="38" class="line none">   38 <a href="../../../source/include/core_http_client.h.html#353">HTTPRequestHeaders_t</a> * <a href="http_cbmc_state.c.html#38">allocateHttpRequestHeaders</a>( <a href="../../../source/include/core_http_client.h.html#353">HTTPRequestHeaders_t</a> * pRequestHeaders )</div><div id="39" class="line none">   39 {</div><div id="40" class="line hit">   40     if( pRequestHeaders == NULL )</div><div id="41" class="line none">   41     {</div><div id="42" class="line hit">   42         pRequestHeaders = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( sizeof( <a href="../../../source/include/core_http_client.h.html#353">HTTPRequestHeaders_t</a> ) );</div><div id="43" class="line hit">   43     }</div><div id="44" class="line none">   44 </div><div id="45" class="line hit">   45     if( pRequestHeaders != NULL )</div><div id="46" class="line none">   46     {</div><div id="47" class="line none">   47         // __CPROVER_assume( pRequestHeaders-&gt;bufferLen &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="48" class="line hit">   48         pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#344">pBuffer</a> = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#345">bufferLen</a> );</div><div id="49" class="line hit">   49     }</div><div id="50" class="line none">   50 </div><div id="51" class="line hit">   51     return pRequestHeaders;</div><div id="52" class="line hit">   52 }</div><div id="53" class="line none">   53 </div><div id="54" class="line none">   54 bool <a href="http_cbmc_state.c.html#54">isValidHttpRequestHeaders</a>( const <a href="../../../source/include/core_http_client.h.html#353">HTTPRequestHeaders_t</a> * pRequestHeaders )</div><div id="55" class="line none">   55 {</div><div id="56" class="line hit">   56     bool isValid = true;</div><div id="57" class="line none">   57 </div><div id="58" class="line hit">   58     if( pRequestHeaders )</div><div id="59" class="line none">   59     {</div><div id="60" class="line both">   60         isValid = pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#345">bufferLen</a> &lt; CBMC_MAX_OBJECT_SIZE &amp;&amp;</div><div id="61" class="line hit">   61                   pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#352">headersLen</a> &lt; CBMC_MAX_OBJECT_SIZE;</div><div id="62" class="line hit">   62     }</div><div id="63" class="line none">   63 </div><div id="64" class="line hit">   64     return isValid;</div><div id="65" class="line hit">   65 }</div><div id="66" class="line none">   66 </div><div id="67" class="line none">   67 <a href="../../../source/include/core_http_client.h.html#387">HTTPRequestInfo_t</a> * <a href="http_cbmc_state.c.html#67">allocateHttpRequestInfo</a>( <a href="../../../source/include/core_http_client.h.html#387">HTTPRequestInfo_t</a> * pRequestInfo )</div><div id="68" class="line none">   68 {</div><div id="69" class="line hit">   69     if( pRequestInfo == NULL )</div><div id="70" class="line none">   70     {</div><div id="71" class="line hit">   71         pRequestInfo = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( sizeof( <a href="../../../source/include/core_http_client.h.html#387">HTTPRequestInfo_t</a> ) );</div><div id="72" class="line hit">   72     }</div><div id="73" class="line none">   73 </div><div id="74" class="line hit">   74     if( pRequestInfo != NULL )</div><div id="75" class="line none">   75     {</div><div id="76" class="line none">   76         // __CPROVER_assume( pRequestInfo-&gt;methodLen &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="77" class="line hit">   77         pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#364">pMethod</a> = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#365">methodLen</a> );</div><div id="78" class="line none">   78 </div><div id="79" class="line none">   79         // __CPROVER_assume( pRequestInfo-&gt;hostLen &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="80" class="line hit">   80         pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#378">pHost</a> = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#379">hostLen</a> );</div><div id="81" class="line none">   81 </div><div id="82" class="line none">   82         // __CPROVER_assume( pRequestInfo-&gt;pathLen &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="83" class="line hit">   83         pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#370">pPath</a> = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#371">pathLen</a> );</div><div id="84" class="line hit">   84     }</div><div id="85" class="line none">   85 </div><div id="86" class="line hit">   86     return pRequestInfo;</div><div id="87" class="line hit">   87 }</div><div id="88" class="line none">   88 </div><div id="89" class="line none">   89 bool <a href="http_cbmc_state.c.html#89">isValidHttpRequestInfo</a>( const <a href="../../../source/include/core_http_client.h.html#387">HTTPRequestInfo_t</a> * pRequestInfo )</div><div id="90" class="line none">   90 {</div><div id="91" class="line hit">   91     bool isValid = true;</div><div id="92" class="line none">   92 </div><div id="93" class="line hit">   93     if( pRequestInfo )</div><div id="94" class="line none">   94     {</div><div id="95" class="line both">   95         isValid = ( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#365">methodLen</a> &lt; CBMC_MAX_OBJECT_SIZE ) &amp;&amp;</div><div id="96" class="line hit">   96                   ( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#379">hostLen</a> &lt; CBMC_MAX_OBJECT_SIZE ) &amp;&amp;</div><div id="97" class="line both">   97                   ( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#371">pathLen</a> &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="98" class="line hit">   98     }</div><div id="99" class="line none">   99 </div><div id="100" class="line hit">  100     return isValid;</div><div id="101" class="line hit">  101 }</div><div id="102" class="line none">  102 </div><div id="103" class="line none">  103 <a href="../../../source/include/core_http_client.h.html#534">HTTPResponse_t</a> * <a href="http_cbmc_state.c.html#103">allocateHttpResponse</a>( <a href="../../../source/include/core_http_client.h.html#534">HTTPResponse_t</a> * <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a> )</div><div id="104" class="line none">  104 {</div><div id="105" class="line none">  105     size_t headerOffset, bodyOffset;</div><div id="106" class="line none">  106 </div><div id="107" class="line none">  107     if( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a> == NULL )</div><div id="108" class="line none">  108     {</div><div id="109" class="line none">  109         <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a> = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( sizeof( <a href="../../../source/include/core_http_client.h.html#534">HTTPResponse_t</a> ) );</div><div id="110" class="line none">  110     }</div><div id="111" class="line none">  111 </div><div id="112" class="line none">  112     if( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a> != NULL )</div><div id="113" class="line none">  113     {</div><div id="114" class="line none">  114         // __CPROVER_assume( pResponse-&gt;bufferLen &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="115" class="line none">  115         <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#344">pBuffer</a> = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#345">bufferLen</a> );</div><div id="116" class="line none">  116 </div><div id="117" class="line none">  117         // __CPROVER_assume( headerOffset &lt;= pResponse-&gt;bufferLen );</div><div id="118" class="line none">  118 </div><div id="119" class="line none">  119         if( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#344">pBuffer</a> != NULL )</div><div id="120" class="line none">  120         {</div><div id="121" class="line none">  121             /* It is possible to have no headers in the response so set to NULL or</div><div id="122" class="line none">  122              * an offset in the response buffer. */</div><div id="123" class="line none">  123             <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#481">pHeaders</a> = <a href="../include/http_cbmc_state.h.html#47">nondet_bool</a>() ? NULL :</div><div id="124" class="line none">  124                                   <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#344">pBuffer</a> + headerOffset;</div><div id="125" class="line none">  125         }</div><div id="126" class="line none">  126 </div><div id="127" class="line none">  127         if( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#481">pHeaders</a> != NULL )</div><div id="128" class="line none">  128         {</div><div id="129" class="line none">  129             /* The length of the headers MUST be between the start of the</div><div id="130" class="line none">  130              * headers and the end of the buffer. */</div><div id="131" class="line none">  131             // __CPROVER_assume( pResponse-&gt;headersLen &lt; ( pResponse-&gt;bufferLen - headerOffset ) );</div><div id="132" class="line none">  132         }</div><div id="133" class="line none">  133 </div><div id="134" class="line none">  134         if( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#345">bufferLen</a> == 0 )</div><div id="135" class="line none">  135         {</div><div id="136" class="line none">  136             bodyOffset = 0;</div><div id="137" class="line none">  137         }</div><div id="138" class="line none">  138         else</div><div id="139" class="line none">  139         {</div><div id="140" class="line none">  140             // __CPROVER_assume( bodyOffset &lt;= pResponse-&gt;bufferLen );</div><div id="141" class="line none">  141         }</div><div id="142" class="line none">  142 </div><div id="143" class="line none">  143         if( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#344">pBuffer</a> != NULL )</div><div id="144" class="line none">  144         {</div><div id="145" class="line none">  145             <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#495">pBody</a> = <a href="../include/http_cbmc_state.h.html#47">nondet_bool</a>() ? NULL :</div><div id="146" class="line none">  146                                <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#344">pBuffer</a> + bodyOffset;</div><div id="147" class="line none">  147         }</div><div id="148" class="line none">  148 </div><div id="149" class="line none">  149         /* The length of the body MUST be between the start of body and the end</div><div id="150" class="line none">  150          * of the buffer. */</div><div id="151" class="line none">  151         if( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#495">pBody</a> )</div><div id="152" class="line none">  152         {</div><div id="153" class="line none">  153             // __CPROVER_assume( pResponse-&gt;bodyLen &lt; ( pResponse-&gt;bufferLen - bodyOffset ) );</div><div id="154" class="line none">  154         }</div><div id="155" class="line none">  155     }</div><div id="156" class="line none">  156 </div><div id="157" class="line none">  157     return <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>;</div><div id="158" class="line none">  158 }</div><div id="159" class="line none">  159 </div><div id="160" class="line none">  160 bool <a href="http_cbmc_state.c.html#160">isValidHttpResponse</a>( const <a href="../../../source/include/core_http_client.h.html#534">HTTPResponse_t</a> * <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a> )</div><div id="161" class="line none">  161 {</div><div id="162" class="line none">  162     bool isValid = true;</div><div id="163" class="line none">  163 </div><div id="164" class="line none">  164     if( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a> )</div><div id="165" class="line none">  165     {</div><div id="166" class="line none">  166         isValid = ( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#345">bufferLen</a> &lt; CBMC_MAX_OBJECT_SIZE ) &amp;&amp;</div><div id="167" class="line none">  167                   ( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#502">bodyLen</a> &lt; <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#345">bufferLen</a> ) &amp;&amp;</div><div id="168" class="line none">  168                   ( <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#352">headersLen</a> &lt; <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#345">bufferLen</a> );</div><div id="169" class="line none">  169         isValid = isValid || <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#495">pBody</a> == NULL;</div><div id="170" class="line none">  170     }</div><div id="171" class="line none">  171 </div><div id="172" class="line none">  172     return isValid;</div><div id="173" class="line none">  173 }</div><div id="174" class="line none">  174 </div><div id="175" class="line none">  175 <a href="../../../source/interface/transport_interface.h.html#256">TransportInterface_t</a> * <a href="http_cbmc_state.c.html#175">allocateTransportInterface</a>( <a href="../../../source/interface/transport_interface.h.html#256">TransportInterface_t</a> * pTransport )</div><div id="176" class="line none">  176 {</div><div id="177" class="line none">  177     if( pTransport == NULL )</div><div id="178" class="line none">  178     {</div><div id="179" class="line none">  179         pTransport = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( sizeof( <a href="../../../source/interface/transport_interface.h.html#256">TransportInterface_t</a> ) );</div><div id="180" class="line none">  180     }</div><div id="181" class="line none">  181 </div><div id="182" class="line none">  182     if( pTransport != NULL )</div><div id="183" class="line none">  183     {</div><div id="184" class="line none">  184         pTransport-&gt;<a href="../../../source/interface/transport_interface.h.html#255">pNetworkContext</a> = <a href="http_cbmc_state.c.html#32">mallocCanFail</a>( sizeof( <a href="../../../source/interface/transport_interface.h.html#189">NetworkContext_t</a> ) );</div><div id="185" class="line none">  185     }</div><div id="186" class="line none">  186 </div><div id="187" class="line none">  187     return pTransport;</div><div id="188" class="line none">  188 }</div><div id="189" class="line none">  189 </div><div id="190" class="line none">  190 bool <a href="http_cbmc_state.c.html#190">isValidTransportInterface</a>( <a href="../../../source/interface/transport_interface.h.html#256">TransportInterface_t</a> * pTransportInterface )</div><div id="191" class="line none">  191 {</div><div id="192" class="line none">  192     bool isValid = true;</div><div id="193" class="line none">  193 </div><div id="194" class="line none">  194     if( pTransportInterface )</div><div id="195" class="line none">  195     {</div><div id="196" class="line none">  196         isValid = isValid &amp;&amp; ( pTransportInterface-&gt;<a href="../../../source/interface/transport_interface.h.html#254">send</a> == <a href="../include/transport_interface_stubs.h.html#49">TransportInterfaceSendStub</a> ||</div><div id="197" class="line none">  197                                pTransportInterface-&gt;<a href="../../../source/interface/transport_interface.h.html#254">send</a> == NULL );</div><div id="198" class="line none">  198         isValid = isValid &amp;&amp; ( pTransportInterface-&gt;<a href="../../../source/interface/transport_interface.h.html#253">recv</a> == <a href="../include/transport_interface_stubs.h.html#62">TransportInterfaceReceiveStub</a> ||</div><div id="199" class="line none">  199                                pTransportInterface-&gt;<a href="../../../source/interface/transport_interface.h.html#253">recv</a> == NULL );</div><div id="200" class="line none">  200     }</div><div id="201" class="line none">  201 }</div><div id="202" class="line none">  202 </div><div id="203" class="line none">  203 <a href="../../../source/dependency/3rdparty/http_parser/http_parser.h.html#68">http_parser</a> * <a href="http_cbmc_state.c.html#203">allocateHttpSendParser</a>( <a href="../../../source/dependency/3rdparty/http_parser/http_parser.h.html#68">http_parser</a> * pHttpParser )</div><div id="204" class="line none">  204 {</div><div id="205" class="line none">  205     <a href="../../../source/include/core_http_client_private.h.html#274">HTTPParsingContext_t</a> * pHttpParsingContext;</div><div id="206" class="line none">  206 </div><div id="207" class="line none">  207     if( pHttpParser == NULL )</div><div id="208" class="line none">  208     {</div><div id="209" class="line none">  209         pHttpParser = malloc( sizeof( <a href="../../../source/dependency/3rdparty/http_parser/http_parser.h.html#68">http_parser</a> ) );</div><div id="210" class="line none">  210         // __CPROVER_assume( pHttpParser != NULL );</div><div id="211" class="line none">  211     }</div><div id="212" class="line none">  212 </div><div id="213" class="line none">  213     pHttpParsingContext = <a href="http_cbmc_state.c.html#220">allocateHttpSendParsingContext</a>( NULL );</div><div id="214" class="line none">  214     // __CPROVER_assume( isValidHttpSendParsingContext( pHttpParsingContext ) );</div><div id="215" class="line none">  215     pHttpParser-&gt;<a href="../../../source/dependency/3rdparty/http_parser/http_parser.h.html#330">data</a> = ( void * ) pHttpParsingContext;</div><div id="216" class="line none">  216 </div><div id="217" class="line none">  217     return pHttpParser;</div><div id="218" class="line none">  218 }</div><div id="219" class="line none">  219 </div><div id="220" class="line none">  220 <a href="../../../source/include/core_http_client_private.h.html#274">HTTPParsingContext_t</a> * <a href="http_cbmc_state.c.html#220">allocateHttpSendParsingContext</a>( <a href="../../../source/include/core_http_client_private.h.html#274">HTTPParsingContext_t</a> * pHttpParsingContext )</div><div id="221" class="line none">  221 {</div><div id="222" class="line none">  222     <a href="../../../source/include/core_http_client.h.html#534">HTTPResponse_t</a> * <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>;</div><div id="223" class="line none">  223     size_t bufferOffset;</div><div id="224" class="line none">  224 </div><div id="225" class="line none">  225     if( pHttpParsingContext == NULL )</div><div id="226" class="line none">  226     {</div><div id="227" class="line none">  227         pHttpParsingContext = malloc( sizeof( <a href="../../../source/include/core_http_client_private.h.html#274">HTTPParsingContext_t</a> ) );</div><div id="228" class="line none">  228         // __CPROVER_assume( pHttpParsingContext != NULL );</div><div id="229" class="line none">  229 </div><div id="230" class="line none">  230         <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a> = <a href="http_cbmc_state.c.html#103">allocateHttpResponse</a>( NULL );</div><div id="231" class="line none">  231         /*</div><div id="232" class="line none">  232         __CPROVER_assume( isValidHttpResponse( pResponse ) &amp;&amp;</div><div id="233" class="line none">  233                           pResponse != NULL &amp;&amp;</div><div id="234" class="line none">  234                           pResponse-&gt;pBuffer != NULL &amp;&amp;</div><div id="235" class="line none">  235                           pResponse-&gt;bufferLen &gt; 0 );</div><div id="236" class="line none">  236         */</div><div id="237" class="line none">  237         pHttpParsingContext-&gt;<a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a> = <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>;</div><div id="238" class="line none">  238 </div><div id="239" class="line none">  239         // __CPROVER_assume( bufferOffset &lt; pResponse-&gt;bufferLen );</div><div id="240" class="line none">  240         pHttpParsingContext-&gt;<a href="../../../source/include/core_http_client_private.h.html#269">pBufferCur</a> = <a href="../../../source/include/core_http_client_private.h.html#266">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#344">pBuffer</a> + bufferOffset;</div><div id="241" class="line none">  241     }</div><div id="242" class="line none">  242 </div><div id="243" class="line none">  243     return pHttpParsingContext;</div><div id="244" class="line none">  244 }</div><div id="245" class="line none">  245 </div><div id="246" class="line none">  246 bool <a href="http_cbmc_state.c.html#246">isValidHttpSendParsingContext</a>( const <a href="../../../source/include/core_http_client_private.h.html#274">HTTPParsingContext_t</a> * pHttpParsingContext )</div><div id="247" class="line none">  247 {</div><div id="248" class="line none">  248     bool isValid = true;</div><div id="249" class="line none">  249 </div><div id="250" class="line none">  250     isValid = isValid &amp;&amp; ( pHttpParsingContext-&gt;<a href="../../../source/include/core_http_client_private.h.html#271">lastHeaderFieldLen</a> ) &lt;= ( SIZE_MAX - CBMC_MAX_OBJECT_SIZE );</div><div id="251" class="line none">  251     isValid = isValid &amp;&amp; ( pHttpParsingContext-&gt;<a href="../../../source/include/core_http_client_private.h.html#273">lastHeaderValueLen</a> ) &lt;= ( SIZE_MAX - CBMC_MAX_OBJECT_SIZE );</div><div id="252" class="line none">  252 </div><div id="253" class="line none">  253     return isValid;</div><div id="254" class="line none">  254 }</div><div id="255" class="line none">  255 </div><div id="256" class="line none">  256 <a href="../../../source/dependency/3rdparty/http_parser/http_parser.h.html#68">http_parser</a> * <a href="http_cbmc_state.c.html#256">allocateHttpReadHeaderParser</a>( <a href="../../../source/dependency/3rdparty/http_parser/http_parser.h.html#68">http_parser</a> * pHttpParser )</div><div id="257" class="line none">  257 {</div><div id="258" class="line none">  258     <a href="../../../source/include/core_http_client_private.h.html#274">HTTPParsingContext_t</a> * pFindHeaderContext;</div><div id="259" class="line none">  259 </div><div id="260" class="line none">  260     if( pHttpParser == NULL )</div><div id="261" class="line none">  261     {</div><div id="262" class="line none">  262         pHttpParser = malloc( sizeof( <a href="../../../source/dependency/3rdparty/http_parser/http_parser.h.html#68">http_parser</a> ) );</div><div id="263" class="line none">  263         // __CPROVER_assume( pHttpParser != NULL );</div><div id="264" class="line none">  264     }</div><div id="265" class="line none">  265 </div><div id="266" class="line none">  266     pFindHeaderContext = <a href="http_cbmc_state.c.html#272">allocateFindHeaderContext</a>( NULL );</div><div id="267" class="line none">  267     pHttpParser-&gt;<a href="../../../source/dependency/3rdparty/http_parser/http_parser.h.html#330">data</a> = ( void * ) pFindHeaderContext;</div><div id="268" class="line none">  268 </div><div id="269" class="line none">  269     return pHttpParser;</div><div id="270" class="line none">  270 }</div><div id="271" class="line none">  271 </div><div id="272" class="line none">  272 <a href="../../../source/include/core_http_client_private.h.html#204">findHeaderContext_t</a> * <a href="http_cbmc_state.c.html#272">allocateFindHeaderContext</a>( <a href="../../../source/include/core_http_client_private.h.html#204">findHeaderContext_t</a> * pFindHeaderContext )</div><div id="273" class="line none">  273 {</div><div id="274" class="line none">  274     if( pFindHeaderContext == NULL )</div><div id="275" class="line none">  275     {</div><div id="276" class="line none">  276         pFindHeaderContext = malloc( sizeof( <a href="../../../source/include/core_http_client_private.h.html#204">findHeaderContext_t</a> ) );</div><div id="277" class="line none">  277         // __CPROVER_assume( pFindHeaderContext != NULL );</div><div id="278" class="line none">  278     }</div><div id="279" class="line none">  279 </div><div id="280" class="line none">  280     return pFindHeaderContext;</div><div id="281" class="line none">  281 }</div>
</div>
</body>
</html>
